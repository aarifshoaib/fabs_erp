<!-- Add Party Modal -->
<div class="offcanvas offcanvas-end offcanvas-large" tabindex="-1" id="offcanvas_add">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">Add New Party</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <form id="add-party-form" method="POST" action="/create-party/" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="customer_code" class="form-label">Customer Code</label>
                        <input type="text" class="form-control" name="customer_code" readonly>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="customer_name" class="form-label">Customer Name<span class="text-danger">*</span></label>
                        <input type="text" class="form-control" name="customer_name" required>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="party_type" class="form-label">Party Type<span class="text-danger">*</span></label>
                        <select name="party_type" class="form-control select" required>
                            <option value="">Select Party Type</option>
                            {% for type in party_type_data %}
                            <option value="{{ type.base_value }}">{{ type.base_description }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="trade_license" class="form-label">Trade License</label>
                        <input type="text" class="form-control" name="trade_license">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="physical_address" class="form-label">Physical Address</label>
                        <textarea class="form-control" name="physical_address" rows="2"></textarea>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="po_box" class="form-label">P.O. Box</label>
                        <input type="text" class="form-control" name="po_box">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="emirates" class="form-label">Emirates</label>
                        <select name="emirates" class="form-control select2" multiple="multiple">
                            <option value="">Select Emirates</option>
                            {% for emirate in emirates_list %}
                            <option value="{{ emirate.base_value }}">{{ emirate.base_description }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="country" class="form-label">Country</label>
                        <select name="country" class="form-control select">
                            <option value="">Select Country</option>
                            {% for country in country_data %}
                            <option value="{{ country.base_value }}">{{ country.base_description }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="telephone" class="form-label">Telephone</label>
                        <input type="text" class="form-control" name="telephone">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" name="email">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="contact_person" class="form-label">Contact Person</label>
                        <input type="text" class="form-control" name="contact_person">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="contact_person_phone" class="form-label">Contact Person Phone</label>
                        <input type="text" class="form-control" name="contact_person_phone">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="contact_person_email" class="form-label">Contact Person Email</label>
                        <input type="email" class="form-control" name="contact_person_email">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="tax_treatment" class="form-label">Tax Treatment</label>
                        <select name="tax_treatment" class="form-control select">
                            <option value="">Select Tax Treatment</option>
                            <option value="VAT">VAT Registered</option>
                            <option value="Non-VAT">Non-VAT Registered</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="vat_no" class="form-label">VAT No</label>
                        <input type="text" class="form-control" name="vat_no">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="currency" class="form-label">Currency</label>
                        <select name="currency" class="form-control select">
                            <option value="">Select Currency</option>
                            {% for currency in currency_data %}
                            <option value="{{ currency.base_value }}">{{ currency.base_description }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="payment_terms" class="form-label">Payment Terms</label>
                        <select name="payment_terms" class="form-control select">
                            <option value="">Select Payment Terms</option>
                            <option value="15">15 Days</option>
                            <option value="30">30 Days</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="status" class="form-label">Status</label>
                        <select class="form-select" name="status">
                            <option value="Active">Active</option>
                            <option value="Closed">Closed</option>
                            <option value="Onhold">Onhold</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="file_upload" class="form-label">File Upload</label>
                        <input type="file" class="form-control file" name="file_upload[]" multiple>
                    </div>
                </div>
            </div>
            <div class="text-end">
                <button type="button" class="btn btn-light me-2" data-bs-dismiss="offcanvas">Cancel</button>
                <button type="submit" class="btn btn-primary">Save</button>
            </div>
        </form>
    </div>
</div>

<!-- Edit Party Modal -->
<div class="offcanvas offcanvas-end offcanvas-large" tabindex="-1" id="offcanvas_edit">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">Edit Party</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <form id="edit-party-form" method="POST" action="/party_master_edit/" enctype="multipart/form-data">
            {% csrf_token %}
            <input type="hidden" id="party_id" name="party_id">
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="customer_code" class="form-label">Customer Code <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="customer_code" name="customer_code" required readonly>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="customer_name" class="form-label">Customer Name<span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="customer_name" name="customer_name" required>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="party_type" class="form-label">Party Type<span class="text-danger">*</span></label>
                        <select name="party_type" id="party_type" class="form-control select" required>
                            <option value="">Select Party Type</option>
                            {% for type in party_type_data %}
                            <option value="{{ type.base_value }}">{{ type.base_description }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="trade_license" class="form-label">Trade License</label>
                        <input type="text" class="form-control" id="trade_license" name="trade_license">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="physical_address" class="form-label">Physical Address</label>
                        <textarea class="form-control" id="physical_address" name="physical_address" rows="2"></textarea>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="po_box" class="form-label">P.O. Box</label>
                        <input type="text" class="form-control" id="po_box" name="po_box">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="emirates" class="form-label">Emirates</label>
                        <select name="emirates" id="emirates" class="form-control select2" multiple="multiple">
                            <option value="">Select Emirates</option>
                            {% for emirate in emirates_list %}
                            <option value="{{ emirate.base_value }}">{{ emirate.base_description }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="country" class="form-label">Country</label>
                        <select name="country" id="country" class="form-control select">
                            <option value="">Select Country</option>
                            {% for country in country_data %}
                            <option value="{{ country.base_value }}">{{ country.base_description }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="telephone" class="form-label">Telephone</label>
                        <input type="text" class="form-control" id="telephone" name="telephone">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" name="email">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="contact_person" class="form-label">Contact Person</label>
                        <input type="text" class="form-control" id="contact_person" name="contact_person">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="contact_person_phone" class="form-label">Contact Person Phone</label>
                        <input type="text" class="form-control" id="contact_person_phone" name="contact_person_phone">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="contact_person_email" class="form-label">Contact Person Email</label>
                        <input type="email" class="form-control" id="contact_person_email" name="contact_person_email">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="tax_treatment" class="form-label">Tax Treatment</label>
                        <select name="tax_treatment" id="tax_treatment" class="form-control select">
                            <option value="">Select Tax Treatment</option>
                            <option value="VAT">VAT Registered</option>
                            <option value="Non-VAT">Non-VAT Registered</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="vat_no" class="form-label">VAT No</label>
                        <input type="text" class="form-control" id="vat_no" name="vat_no">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="currency" class="form-label">Currency</label>
                        <select name="currency" id="currency" class="form-control select">
                            <option value="">Select Currency</option>
                            {% for currency in currency_data %}
                            <option value="{{ currency.base_value }}">{{ currency.base_description }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="payment_terms" class="form-label">Payment Terms</label>
                        <select name="payment_terms" id="payment_terms" class="form-control select">
                            <option value="">Select Payment Terms</option>
                            <option value="15">15 Days</option>
                            <option value="30">30 Days</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="status" class="form-label">Status</label>
                        <select class="form-select" id="status" name="status">
                            <option value="Active">Active</option>
                            <option value="Closed">Closed</option>
                            <option value="Onhold">Onhold</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="file_upload" class="form-label">File Upload</label>
                        <input type="file" class="form-control file" name="file_upload[]" id="file_upload" multiple>
                    </div>
                </div>
                <div class="accordion" id="partyAccordion">
                    <!-- Party Documents Accordion -->
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingPartyDocs">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapsePartyDocs" aria-expanded="false"
                                aria-controls="collapsePartyDocs">
                                Party Documents
                            </button>
                        </h2>
                        <div id="collapsePartyDocs" class="accordion-collapse collapse" aria-labelledby="headingPartyDocs"
                            data-bs-parent="#partyAccordion">
                            <div class="accordion-body">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>File Name</th>
                                            <th>Preview</th>
                                            <th>Download</th>
                                        </tr>
                                    </thead>
                                    <tbody id="party-files-body">
                                        <!-- Files will be dynamically loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
            <div class="text-end">
                <button type="button" class="btn btn-light me-2" data-bs-dismiss="offcanvas">Cancel</button>
                <button type="submit" class="btn btn-primary">Update</button>
            </div>
        </form>
    </div>
</div>

<!-- Delete Party Modal -->
<div class="modal fade" id="delete_party" tabindex="-1" aria-labelledby="deletePartyLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deletePartyLabel">Delete Party</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this party?
            </div>
            <div class="modal-footer">
                <form id="delete-party-form" method="POST" action="/delete-party/">
                    {% csrf_token %}
                    <input type="hidden" id="delete_party_id" name="party_id">
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Add Employee Passport Details Offcanvas -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvas_add" style="width: 1000px !important;">
    <div class="offcanvas-header border-bottom">
        <h5 class="offcanvas-title" id="offcanvas_add_employee_pp_label">Add Employee PLVP Details</h5>
        <button type="button" class="btn-close custom-btn-close border p-1 me-0 d-flex align-items-center justify-content-center rounded-circle" data-bs-dismiss="offcanvas" aria-label="Close">
            <i class="ti ti-x"></i>
        </button>
    </div>
    <div class="offcanvas-body">
        <form id="addEmployeePPForm" action="{% url 'employee_pp_create' %}" method="POST">
            {% csrf_token %}
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Employee Code</label>
                    <select name="emp_code" id="add_emp_code" class="form-control select2">
                        <option value="">Select Employee Code</option>
                        {% for employee in employee_data %}
                        <option value="{{ employee.emp_code }}">{{ employee.emp_code }} - {{ employee.emp_name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Passport Number</label>
                    <input type="text" name="pp_number" id="add_pp_number" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Name</label>
                    <input type="text" name="name" id="add_name" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">In/Outside</label>
                    <select name="in_outside" id="add_in_outside" class="form-control">
                        <option value="">Select</option>
                        <option value="inside">Inside</option>
                        <option value="outside">Outside</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Status</label>
                    <select name="status" id="add_status" class="form-control">
                        <option value="">Select</option>
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Sub Status</label>
                    <input type="text" name="sub_status" id="add_sub_status" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Work Location</label>
                    <input type="text" name="work_location" id="add_work_location" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Date of Joining</label>
                    <input type="date" name="doj" id="add_doj" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Gender</label>
                    <select name="gender" id="add_gender" class="form-control">
                        <option value="">Select</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Designation</label>
                    <select name="designation" id="add_designation" class="form-control">
                        <option value="">Select</option>
                        {% for designation in desig_data %}
                        <option value="{{ designation.base_value }}">{{ designation.base_value }} - {{ designation.base_description }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Nationality</label>
                    <select name="nationality" id="add_nationality" class="form-control">
                        <option value="">Select</option>
                        {% for nationality in nation_data %}
                        <option value="{{ nationality.base_value }}">{{ nationality.base_value }} - {{ nationality.base_description }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">PP Control</label>
                    <select name="pp_control" id="add_pp_control" class="form-control">
                        <option value="">Select</option>
                        <option value="Yes">Yes</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Date of Landing</label>
                    <input type="date" name="date_of_landing" id="add_date_of_landing" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">No of Days</label>
                    <input type="number" name="no_of_days" id="add_no_of_days" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Medical</label>
                    <select name="medical" id="add_medical" class="form-control">
                        <option value="">Select</option>
                        {% for medical_status in medical_status_data %}
                        <option value="{{ medical_status.base_value }}">{{ medical_status.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Not Done">Not Done</option>
                        <option value="Typed/Medical to do">Typed/Medical to do</option>
                        <option value="Medical Done, Waiting for result">Medical Done, Waiting for result</option>
                        <option value="Fit">Fit</option>
                        <option value="Remedial to do">Remedial to do</option>
                        <option value="Remedial Done, waiting for result">Remedial Done, waiting for result</option>
                        <option value="Unfit, Cancelled & Exit">Unfit, Cancelled & Exit</option> -->
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Medical Result Date</label>
                    <input type="date" name="medical_result_date" id="add_medical_result_date" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Remedical Result Date</label>
                    <input type="date" name="remedical_result_date" id="add_remedical_result_date" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">EID</label>
                    <select name="eid" id="add_eid" class="form-control">
                        <option value="">Select</option>
                        {% for eid_status in eid_status_data %}
                        <option value="{{ eid_status.base_value }}">{{ eid_status.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Not Done">Not Done</option>
                        <option value="Date to mention">Date to mention</option>
                        <option value="Biometric Done, Waiting for card">Biometric Done, Waiting for card</option>
                        <option value="Typed, Interchange">Typed, Interchange</option>
                        <option value="Card Recevied">Card Recevied</option>
                        <option value="Cancelled & Exit">Cancelled & Exit</option> -->
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">RP Stamping</label>
                    <select name="rp_stamping" id="add_rp_stamping" class="form-control">
                        <option value="">Select</option>
                        {% for rp_stamping in rp_stamping_data %}
                        <option value="{{ rp_stamping.base_value }}">{{ rp_stamping.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Stamped">Stamped</option>
                        <option value="Not Done">Not Done</option>
                        <option value="Cancelled and Exit">Cancelled and Exit</option> -->
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Fine Amount</label>
                    <input type="number" step="0.01" name="fine_amount" id="add_fine_amount" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Tawjeeh Payment</label>
                    <select name="tawjeeh_payment" id="add_tawjeeh_payment" class="form-control">
                        <option value="">Select</option>
                        {% for tawjeeh_payment_status in tawjeeh_payment_status_data %}
                        <option value="{{ tawjeeh_payment_status.base_value }}">{{ tawjeeh_payment_status.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Done">Done</option>
                        <option value="Not Done">Not Done</option>
                        <option value="To Do">To Do</option> -->
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Tawjeeh Class</label>
                    <select name="tawjeeh_class" id="add_tawjeeh_class" class="form-control">
                        <option value="">Select</option>
                        {% for tawjeeh_class_status in tawjeeh_class_status_data %}
                        <option value="{{ tawjeeh_class_status.base_value }}">{{ tawjeeh_class_status.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Class Done">Class Done</option>
                        <option value="Class Not Done">Class Not Done</option> -->
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">ILOE Status</label>
                    <select name="iloe_status" id="add_iloe_status" class="form-control">
                        <option value="">Select</option>
                        {% for ioe_status in ioe_status_data %}
                        <option value="{{ ioe_status.base_value }}">{{ ioe_status.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Done">Done</option>
                        <option value="Not Done">Not Done</option> -->
                    </select>
                </div>
            </div>
            <div class="d-flex justify-content-end">
                <button type="button" class="btn btn-light me-2" data-bs-dismiss="offcanvas">Cancel</button>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div>

<script>
$(function() {
    $('#add_emp_code').change(function() {
        var emp_code = $(this).val();
        if (emp_code) {
            $.ajax({
                url: "{% url 'get_employee_details_by_code' %}",
                type: "GET",
                data: { emp_code: emp_code },
                success: function(response) {
                    if (response.success) {
                        var d = response.data;
                        $('#add_pp_number').val(d.pp_number || '');
                        $('#add_name').val(d.name || '');
                        $('#add_in_outside').val(d.in_outside || '');
                        $('#add_status').val(d.status || '');
                        $('#add_sub_status').val(d.sub_status || '');
                        $('#add_work_location').val(d.work_location || '');
                        $('#add_doj').val(d.doj || '');
                        $('#add_gender').val(d.gender || '');
                        $('#add_designation').val(d.designation || '');
                        $('#add_nationality').val(d.nationality || '');
                    } else {
                        // Optionally clear fields if not found
                    }
                }
            });
        }
    });
});
</script>

<!-- Edit Employee Passport Details Offcanvas -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvas_edit" style="width: 1000px !important;">
    <div class="offcanvas-header border-bottom">
        <h5 class="offcanvas-title" id="offcanvas_edit_employee_pp_label">Edit Employee PLVP Details</h5>
        <button type="button" class="btn-close custom-btn-close border p-1 me-0 d-flex align-items-center justify-content-center rounded-circle" data-bs-dismiss="offcanvas" aria-label="Close">
            <i class="ti ti-x"></i>
        </button>
    </div>
    <div class="offcanvas-body">
        <form id="editEmployeePPForm" action="{% url 'employee_pp_update' %}" method="POST">
            {% csrf_token %}
            <input type="hidden" name="id" id="edit_id">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Employee Code</label>
                    <select name="emp_code" id="edit_emp_code" class="form-control select2">
                        <option value="">Select Employee Code</option>
                        {% for employee in employee_data %}
                        <option value="{{ employee.emp_code }}">{{ employee.emp_code }} - {{ employee.emp_name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Passport Number</label>
                    <input type="text" name="pp_number" id="edit_pp_number" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Name</label>
                    <input type="text" name="name" id="edit_name" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">In/Outside</label>
                    <select name="in_outside" id="edit_in_outside" class="form-control">
                        <option value="">Select</option>
                        <option value="inside">Inside</option>
                        <option value="outside">Outside</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Status</label>
                    <select name="status" id="edit_status" class="form-control">
                        <option value="">Select</option>
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Sub Status</label>
                    <input type="text" name="sub_status" id="edit_sub_status" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Work Location</label>
                    <input type="text" name="work_location" id="edit_work_location" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Date of Joining</label>
                    <input type="date" name="doj" id="edit_doj" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Gender</label>
                    <select name="gender" id="edit_gender" class="form-control">
                        <option value="">Select</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Designation</label>
                    <select name="designation" id="edit_designation" class="form-control">
                        <option value="">Select</option>
                        {% for designation in desig_data %}
                        <option value="{{ designation.base_value }}">{{ designation.base_value }} - {{ designation.base_description }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Nationality</label>
                    <select name="nationality" id="edit_nationality" class="form-control">
                        <option value="">Select</option>
                        {% for nationality in nation_data %}
                        <option value="{{ nationality.base_value }}">{{ nationality.base_value }} - {{ nationality.base_description }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">PP Control</label>
                    <select name="pp_control" id="edit_pp_control" class="form-control">
                        <option value="">Select</option>
                        <option value="Yes">Yes</option>
                        <option value="No">No</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Date of Landing</label>
                    <input type="date" name="date_of_landing" id="edit_date_of_landing" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">No of Days</label>
                    <input type="number" name="no_of_days" id="edit_no_of_days" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Medical</label>
                    <select name="medical" id="edit_medical" class="form-control">
                        <option value="">Select</option>
                        {% for medical_status in medical_status_data %}
                        <option value="{{ medical_status.base_value }}">{{ medical_status.base_value }} - {{ medical_status.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Not Done">Not Done</option>
                        <option value="Typed/Medical to do">Typed/Medical to do</option>
                        <option value="Medical Done, Waiting for result">Medical Done, Waiting for result</option>
                        <option value="Fit">Fit</option>
                        <option value="Remedial to do">Remedial to do</option>
                        <option value="Remedial Done, waiting for result">Remedial Done, waiting for result</option>
                        <option value="Unfit, Cancelled & Exit">Unfit, Cancelled & Exit</option> -->
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Medical Result Date</label>
                    <input type="date" name="medical_result_date" id="edit_medical_result_date" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Remedical Result Date</label>
                    <input type="date" name="remedical_result_date" id="edit_remedical_result_date" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">EID</label>
                    <select name="eid" id="edit_eid" class="form-control">
                        <option value="">Select</option>
                        {% for eid_status in eid_status_data %}
                        <option value="{{ eid_status.base_value }}">{{ eid_status.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Not Done">Not Done</option>
                        <option value="Date to mention">Date to mention</option>
                        <option value="Biometric Done, Waiting for card">Biometric Done, Waiting for card</option>
                        <option value="Typed, Interchange">Typed, Interchange</option>
                        <option value="Card Recevied">Card Recevied</option>
                        <option value="Cancelled & Exit">Cancelled & Exit</option> -->
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">RP Stamping</label>
                    <select name="rp_stamping" id="edit_rp_stamping" class="form-control">
                        <option value="">Select</option>
                        {% for rp_stamping in rp_stamping_data %}
                        <option value="{{ rp_stamping.base_value }}">{{ rp_stamping.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Stamped">Stamped</option>
                        <option value="Not Done">Not Done</option>
                        <option value="Cancelled and Exit">Cancelled and Exit</option> -->
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Fine Amount</label>
                    <input type="number" step="0.01" name="fine_amount" id="edit_fine_amount" class="form-control">
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Tawjeeh Payment</label>
                    <select name="tawjeeh_payment" id="edit_tawjeeh_payment" class="form-control">
                        <option value="">Select</option>
                        {% for tawjeeh_payment_status in tawjeeh_payment_status_data %}
                        <option value="{{ tawjeeh_payment_status.base_value }}">{{ tawjeeh_payment_status.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Done">Done</option>
                        <option value="Not Done">Not Done</option>
                        <option value="To Do">To Do</option> -->
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">Tawjeeh Class</label>
                    <select name="tawjeeh_class" id="edit_tawjeeh_class" class="form-control">
                        <option value="">Select</option>
                        {% for tawjeeh_class_status in tawjeeh_class_status_data %}
                        <option value="{{ tawjeeh_class_status.base_value }}">{{ tawjeeh_class_status.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Class Done">Class Done</option>
                        <option value="Class Not Done">Class Not Done</option> -->
                    </select>
                </div>
                <div class="col-md-4 mb-3">
                    <label class="col-form-label">ILOE Status</label>
                    <select name="iloe_status" id="edit_iloe_status" class="form-control">
                        <option value="">Select</option>
                        {% for ioe_status in ioe_status_data %}
                        <option value="{{ ioe_status.base_value }}">{{ ioe_status.base_description }}</option>
                        {% endfor %}
                        <!-- <option value="Done">Done</option>
                        <option value="Not Done">Not Done</option> -->
                    </select>
                </div>
            </div>
            <div class="d-flex justify-content-end">
                <button type="button" class="btn btn-light me-2" data-bs-dismiss="offcanvas">Cancel</button>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div> 
